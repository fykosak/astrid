version: '3'

services:
  astrid:
    image: astrid
    build:
      context: ..
      dockerfile: docker/Dockerfile
    restart: on-failure:3
    container_name: astrid
    environment:
      TZ: 'Europe/Prague'
    privileged: true # needed for containers
    volumes:
      - ./data:/data
      - /etc/passwd:/etc/passwd:ro # needed for ssh-keygen to work
    ports:
      - 8080:8080 # opened port mapping, not needed with proxy
    user: 1000:1000 # expects the main user as uid:pid
